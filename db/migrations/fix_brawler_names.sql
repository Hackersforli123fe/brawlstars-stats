SET max_memory_usage=0;

ALTER TABLE brawltime.battle UPDATE
  brawler_name=multiIf(brawler_id=16000000, 'SHELLY', brawler_id=16000001, 'COLT', brawler_id=16000002, 'BULL', brawler_id=16000003, 'BROCK', brawler_id=16000004, 'RICO', brawler_id=16000005, 'SPIKE', brawler_id=16000006, 'BARLEY', brawler_id=16000007, 'JESSIE', brawler_id=16000008, 'NITA', brawler_id=16000009, 'DYNAMIKE', brawler_id=16000010, 'EL PRIMO', brawler_id=16000011, 'MORTIS', brawler_id=16000012, 'CROW', brawler_id=16000013, 'POCO', brawler_id=16000014, 'BO', brawler_id=16000015, 'PIPER', brawler_id=16000016, 'PAM', brawler_id=16000017, 'TARA', brawler_id=16000018, 'DARRYL', brawler_id=16000019, 'PENNY', brawler_id=16000020, 'FRANK', brawler_id=16000021, 'GENE', brawler_id=16000022, 'TICK', brawler_id=16000023, 'LEON', brawler_id=16000024, 'ROSA', brawler_id=16000025, 'CARL', brawler_id=16000026, 'BIBI', brawler_id=16000027, '8-BIT', brawler_id=16000028, 'SANDY', brawler_id=16000029, 'BEA', brawler_id=16000030, 'EMZ', brawler_id=16000031, 'MR. P', brawler_id=16000032, 'MAX', brawler_id=16000034, 'JACKY', brawler_id=16000035, 'GALE', brawler_id=16000036, 'NANI', brawler_id=16000037, 'SPROUT', brawler_id=16000038, 'SURGE', brawler_id=16000039, 'COLETTE', brawler_id=16000040, 'AMBER', brawler_id=16000041, 'LOU', brawler_id=16000042, 'BYRON', brawler_id=16000043, 'EDGAR', brawler_id=16000044, 'RUFFS', brawler_id=16000045, 'STU', brawler_id=16000046, 'BELLE', brawler_id=16000047, 'SQUEAK', brawler_id=16000048, 'GROM', brawler_id=16000049, 'BUZZ', brawler_id=16000050, 'GRIFF', brawler_id=16000051, 'ASH', brawler_id=16000052, 'MEG', brawler_id=16000053, 'LOLA', brawler_id=16000054, 'FANG', brawler_id=16000056, 'EVE', brawler_id=16000057, 'JANET', brawler_id=16000058, 'BONNIE', brawler_id=16000059, 'OTIS', brawler_id=16000060, 'SAM', brawler_id=16000061, 'GUS', brawler_id=16000062, 'BUSTER', brawler_id=16000063, 'CHESTER', brawler_id=16000064, 'GRAY', brawler_id=16000065, 'MANDY', brawler_id=16000066, 'R-T', brawler_id=16000067, 'WILLOW', brawler_id=16000068, 'MAISIE', brawler_id=16000069, 'HANK', brawler_id=16000070, 'CORDELIUS', brawler_id=16000071, 'DOUG', brawler_id=16000072, 'PEARL', brawler_id=16000073, 'CHUCK', brawler_id=16000074, 'CHARLIE', brawler_id=16000075, 'MICO', brawler_id=16000076, 'KIT', brawler_id=16000077, 'LARRY & LAWRIE', brawler_id=16000078, 'MELODIE', brawler_id=16000079, 'ANGELO', brawler_id=16000080, 'DRACO', brawler_id=16000081, 'LILY', brawler_id=16000082, 'BERRY', brawler_id=16000083, 'CLANCY', ''),
  battle_starplayer_brawler_name=multiIf(battle_starplayer_brawler_id=16000000, 'SHELLY', battle_starplayer_brawler_id=16000001, 'COLT', battle_starplayer_brawler_id=16000002, 'BULL', battle_starplayer_brawler_id=16000003, 'BROCK', battle_starplayer_brawler_id=16000004, 'RICO', battle_starplayer_brawler_id=16000005, 'SPIKE', battle_starplayer_brawler_id=16000006, 'BARLEY', battle_starplayer_brawler_id=16000007, 'JESSIE', battle_starplayer_brawler_id=16000008, 'NITA', battle_starplayer_brawler_id=16000009, 'DYNAMIKE', battle_starplayer_brawler_id=16000010, 'EL PRIMO', battle_starplayer_brawler_id=16000011, 'MORTIS', battle_starplayer_brawler_id=16000012, 'CROW', battle_starplayer_brawler_id=16000013, 'POCO', battle_starplayer_brawler_id=16000014, 'BO', battle_starplayer_brawler_id=16000015, 'PIPER', battle_starplayer_brawler_id=16000016, 'PAM', battle_starplayer_brawler_id=16000017, 'TARA', battle_starplayer_brawler_id=16000018, 'DARRYL', battle_starplayer_brawler_id=16000019, 'PENNY', battle_starplayer_brawler_id=16000020, 'FRANK', battle_starplayer_brawler_id=16000021, 'GENE', battle_starplayer_brawler_id=16000022, 'TICK', battle_starplayer_brawler_id=16000023, 'LEON', battle_starplayer_brawler_id=16000024, 'ROSA', battle_starplayer_brawler_id=16000025, 'CARL', battle_starplayer_brawler_id=16000026, 'BIBI', battle_starplayer_brawler_id=16000027, '8-BIT', battle_starplayer_brawler_id=16000028, 'SANDY', battle_starplayer_brawler_id=16000029, 'BEA', battle_starplayer_brawler_id=16000030, 'EMZ', battle_starplayer_brawler_id=16000031, 'MR. P', battle_starplayer_brawler_id=16000032, 'MAX', battle_starplayer_brawler_id=16000034, 'JACKY', battle_starplayer_brawler_id=16000035, 'GALE', battle_starplayer_brawler_id=16000036, 'NANI', battle_starplayer_brawler_id=16000037, 'SPROUT', battle_starplayer_brawler_id=16000038, 'SURGE', battle_starplayer_brawler_id=16000039, 'COLETTE', battle_starplayer_brawler_id=16000040, 'AMBER', battle_starplayer_brawler_id=16000041, 'LOU', battle_starplayer_brawler_id=16000042, 'BYRON', battle_starplayer_brawler_id=16000043, 'EDGAR', battle_starplayer_brawler_id=16000044, 'RUFFS', battle_starplayer_brawler_id=16000045, 'STU', battle_starplayer_brawler_id=16000046, 'BELLE', battle_starplayer_brawler_id=16000047, 'SQUEAK', battle_starplayer_brawler_id=16000048, 'GROM', battle_starplayer_brawler_id=16000049, 'BUZZ', battle_starplayer_brawler_id=16000050, 'GRIFF', battle_starplayer_brawler_id=16000051, 'ASH', battle_starplayer_brawler_id=16000052, 'MEG', battle_starplayer_brawler_id=16000053, 'LOLA', battle_starplayer_brawler_id=16000054, 'FANG', battle_starplayer_brawler_id=16000056, 'EVE', battle_starplayer_brawler_id=16000057, 'JANET', battle_starplayer_brawler_id=16000058, 'BONNIE', battle_starplayer_brawler_id=16000059, 'OTIS', battle_starplayer_brawler_id=16000060, 'SAM', battle_starplayer_brawler_id=16000061, 'GUS', battle_starplayer_brawler_id=16000062, 'BUSTER', battle_starplayer_brawler_id=16000063, 'CHESTER', battle_starplayer_brawler_id=16000064, 'GRAY', battle_starplayer_brawler_id=16000065, 'MANDY', battle_starplayer_brawler_id=16000066, 'R-T', battle_starplayer_brawler_id=16000067, 'WILLOW', battle_starplayer_brawler_id=16000068, 'MAISIE', battle_starplayer_brawler_id=16000069, 'HANK', battle_starplayer_brawler_id=16000070, 'CORDELIUS', battle_starplayer_brawler_id=16000071, 'DOUG', battle_starplayer_brawler_id=16000072, 'PEARL', battle_starplayer_brawler_id=16000073, 'CHUCK', battle_starplayer_brawler_id=16000074, 'CHARLIE', battle_starplayer_brawler_id=16000075, 'MICO', battle_starplayer_brawler_id=16000076, 'KIT', battle_starplayer_brawler_id=16000077, 'LARRY & LAWRIE', battle_starplayer_brawler_id=16000078, 'MELODIE', battle_starplayer_brawler_id=16000079, 'ANGELO', battle_starplayer_brawler_id=16000080, 'DRACO', battle_starplayer_brawler_id=16000081, 'LILY', battle_starplayer_brawler_id=16000082, 'BERRY', battle_starplayer_brawler_id=16000083, 'CLANCY', ''),
  battle_bigbrawler_brawler_name=multiIf(battle_bigbrawler_brawler_id=16000000, 'SHELLY', battle_bigbrawler_brawler_id=16000001, 'COLT', battle_bigbrawler_brawler_id=16000002, 'BULL', battle_bigbrawler_brawler_id=16000003, 'BROCK', battle_bigbrawler_brawler_id=16000004, 'RICO', battle_bigbrawler_brawler_id=16000005, 'SPIKE', battle_bigbrawler_brawler_id=16000006, 'BARLEY', battle_bigbrawler_brawler_id=16000007, 'JESSIE', battle_bigbrawler_brawler_id=16000008, 'NITA', battle_bigbrawler_brawler_id=16000009, 'DYNAMIKE', battle_bigbrawler_brawler_id=16000010, 'EL PRIMO', battle_bigbrawler_brawler_id=16000011, 'MORTIS', battle_bigbrawler_brawler_id=16000012, 'CROW', battle_bigbrawler_brawler_id=16000013, 'POCO', battle_bigbrawler_brawler_id=16000014, 'BO', battle_bigbrawler_brawler_id=16000015, 'PIPER', battle_bigbrawler_brawler_id=16000016, 'PAM', battle_bigbrawler_brawler_id=16000017, 'TARA', battle_bigbrawler_brawler_id=16000018, 'DARRYL', battle_bigbrawler_brawler_id=16000019, 'PENNY', battle_bigbrawler_brawler_id=16000020, 'FRANK', battle_bigbrawler_brawler_id=16000021, 'GENE', battle_bigbrawler_brawler_id=16000022, 'TICK', battle_bigbrawler_brawler_id=16000023, 'LEON', battle_bigbrawler_brawler_id=16000024, 'ROSA', battle_bigbrawler_brawler_id=16000025, 'CARL', battle_bigbrawler_brawler_id=16000026, 'BIBI', battle_bigbrawler_brawler_id=16000027, '8-BIT', battle_bigbrawler_brawler_id=16000028, 'SANDY', battle_bigbrawler_brawler_id=16000029, 'BEA', battle_bigbrawler_brawler_id=16000030, 'EMZ', battle_bigbrawler_brawler_id=16000031, 'MR. P', battle_bigbrawler_brawler_id=16000032, 'MAX', battle_bigbrawler_brawler_id=16000034, 'JACKY', battle_bigbrawler_brawler_id=16000035, 'GALE', battle_bigbrawler_brawler_id=16000036, 'NANI', battle_bigbrawler_brawler_id=16000037, 'SPROUT', battle_bigbrawler_brawler_id=16000038, 'SURGE', battle_bigbrawler_brawler_id=16000039, 'COLETTE', battle_bigbrawler_brawler_id=16000040, 'AMBER', battle_bigbrawler_brawler_id=16000041, 'LOU', battle_bigbrawler_brawler_id=16000042, 'BYRON', battle_bigbrawler_brawler_id=16000043, 'EDGAR', battle_bigbrawler_brawler_id=16000044, 'RUFFS', battle_bigbrawler_brawler_id=16000045, 'STU', battle_bigbrawler_brawler_id=16000046, 'BELLE', battle_bigbrawler_brawler_id=16000047, 'SQUEAK', battle_bigbrawler_brawler_id=16000048, 'GROM', battle_bigbrawler_brawler_id=16000049, 'BUZZ', battle_bigbrawler_brawler_id=16000050, 'GRIFF', battle_bigbrawler_brawler_id=16000051, 'ASH', battle_bigbrawler_brawler_id=16000052, 'MEG', battle_bigbrawler_brawler_id=16000053, 'LOLA', battle_bigbrawler_brawler_id=16000054, 'FANG', battle_bigbrawler_brawler_id=16000056, 'EVE', battle_bigbrawler_brawler_id=16000057, 'JANET', battle_bigbrawler_brawler_id=16000058, 'BONNIE', battle_bigbrawler_brawler_id=16000059, 'OTIS', battle_bigbrawler_brawler_id=16000060, 'SAM', battle_bigbrawler_brawler_id=16000061, 'GUS', battle_bigbrawler_brawler_id=16000062, 'BUSTER', battle_bigbrawler_brawler_id=16000063, 'CHESTER', battle_bigbrawler_brawler_id=16000064, 'GRAY', battle_bigbrawler_brawler_id=16000065, 'MANDY', battle_bigbrawler_brawler_id=16000066, 'R-T', battle_bigbrawler_brawler_id=16000067, 'WILLOW', battle_bigbrawler_brawler_id=16000068, 'MAISIE', battle_bigbrawler_brawler_id=16000069, 'HANK', battle_bigbrawler_brawler_id=16000070, 'CORDELIUS', battle_bigbrawler_brawler_id=16000071, 'DOUG', battle_bigbrawler_brawler_id=16000072, 'PEARL', battle_bigbrawler_brawler_id=16000073, 'CHUCK', battle_bigbrawler_brawler_id=16000074, 'CHARLIE', battle_bigbrawler_brawler_id=16000075, 'MICO', battle_bigbrawler_brawler_id=16000076, 'KIT', battle_bigbrawler_brawler_id=16000077, 'LARRY & LAWRIE', battle_bigbrawler_brawler_id=16000078, 'MELODIE', battle_bigbrawler_brawler_id=16000079, 'ANGELO', battle_bigbrawler_brawler_id=16000080, 'DRACO', battle_bigbrawler_brawler_id=16000081, 'LILY', battle_bigbrawler_brawler_id=16000082, 'BERRY', battle_bigbrawler_brawler_id=16000083, 'CLANCY', ''),
  `battle_allies.brawler_name`=arrayMap(bid -> multiIf(bid=16000000, 'SHELLY', bid=16000001, 'COLT', bid=16000002, 'BULL', bid=16000003, 'BROCK', bid=16000004, 'RICO', bid=16000005, 'SPIKE', bid=16000006, 'BARLEY', bid=16000007, 'JESSIE', bid=16000008, 'NITA', bid=16000009, 'DYNAMIKE', bid=16000010, 'EL PRIMO', bid=16000011, 'MORTIS', bid=16000012, 'CROW', bid=16000013, 'POCO', bid=16000014, 'BO', bid=16000015, 'PIPER', bid=16000016, 'PAM', bid=16000017, 'TARA', bid=16000018, 'DARRYL', bid=16000019, 'PENNY', bid=16000020, 'FRANK', bid=16000021, 'GENE', bid=16000022, 'TICK', bid=16000023, 'LEON', bid=16000024, 'ROSA', bid=16000025, 'CARL', bid=16000026, 'BIBI', bid=16000027, '8-BIT', bid=16000028, 'SANDY', bid=16000029, 'BEA', bid=16000030, 'EMZ', bid=16000031, 'MR. P', bid=16000032, 'MAX', bid=16000034, 'JACKY', bid=16000035, 'GALE', bid=16000036, 'NANI', bid=16000037, 'SPROUT', bid=16000038, 'SURGE', bid=16000039, 'COLETTE', bid=16000040, 'AMBER', bid=16000041, 'LOU', bid=16000042, 'BYRON', bid=16000043, 'EDGAR', bid=16000044, 'RUFFS', bid=16000045, 'STU', bid=16000046, 'BELLE', bid=16000047, 'SQUEAK', bid=16000048, 'GROM', bid=16000049, 'BUZZ', bid=16000050, 'GRIFF', bid=16000051, 'ASH', bid=16000052, 'MEG', bid=16000053, 'LOLA', bid=16000054, 'FANG', bid=16000056, 'EVE', bid=16000057, 'JANET', bid=16000058, 'BONNIE', bid=16000059, 'OTIS', bid=16000060, 'SAM', bid=16000061, 'GUS', bid=16000062, 'BUSTER', bid=16000063, 'CHESTER', bid=16000064, 'GRAY', bid=16000065, 'MANDY', bid=16000066, 'R-T', bid=16000067, 'WILLOW', bid=16000068, 'MAISIE', bid=16000069, 'HANK', bid=16000070, 'CORDELIUS', bid=16000071, 'DOUG', bid=16000072, 'PEARL', bid=16000073, 'CHUCK', bid=16000074, 'CHARLIE', bid=16000075, 'MICO', bid=16000076, 'KIT', bid=16000077, 'LARRY & LAWRIE', bid=16000078, 'MELODIE', bid=16000079, 'ANGELO', bid=16000080, 'DRACO', bid=16000081, 'LILY', bid=16000082, 'BERRY', bid=16000083, 'CLANCY', ''), `battle_allies.brawler_id`),
  `battle_enemies.brawler_name`=arrayMap(bid -> multiIf(bid=16000000, 'SHELLY', bid=16000001, 'COLT', bid=16000002, 'BULL', bid=16000003, 'BROCK', bid=16000004, 'RICO', bid=16000005, 'SPIKE', bid=16000006, 'BARLEY', bid=16000007, 'JESSIE', bid=16000008, 'NITA', bid=16000009, 'DYNAMIKE', bid=16000010, 'EL PRIMO', bid=16000011, 'MORTIS', bid=16000012, 'CROW', bid=16000013, 'POCO', bid=16000014, 'BO', bid=16000015, 'PIPER', bid=16000016, 'PAM', bid=16000017, 'TARA', bid=16000018, 'DARRYL', bid=16000019, 'PENNY', bid=16000020, 'FRANK', bid=16000021, 'GENE', bid=16000022, 'TICK', bid=16000023, 'LEON', bid=16000024, 'ROSA', bid=16000025, 'CARL', bid=16000026, 'BIBI', bid=16000027, '8-BIT', bid=16000028, 'SANDY', bid=16000029, 'BEA', bid=16000030, 'EMZ', bid=16000031, 'MR. P', bid=16000032, 'MAX', bid=16000034, 'JACKY', bid=16000035, 'GALE', bid=16000036, 'NANI', bid=16000037, 'SPROUT', bid=16000038, 'SURGE', bid=16000039, 'COLETTE', bid=16000040, 'AMBER', bid=16000041, 'LOU', bid=16000042, 'BYRON', bid=16000043, 'EDGAR', bid=16000044, 'RUFFS', bid=16000045, 'STU', bid=16000046, 'BELLE', bid=16000047, 'SQUEAK', bid=16000048, 'GROM', bid=16000049, 'BUZZ', bid=16000050, 'GRIFF', bid=16000051, 'ASH', bid=16000052, 'MEG', bid=16000053, 'LOLA', bid=16000054, 'FANG', bid=16000056, 'EVE', bid=16000057, 'JANET', bid=16000058, 'BONNIE', bid=16000059, 'OTIS', bid=16000060, 'SAM', bid=16000061, 'GUS', bid=16000062, 'BUSTER', bid=16000063, 'CHESTER', bid=16000064, 'GRAY', bid=16000065, 'MANDY', bid=16000066, 'R-T', bid=16000067, 'WILLOW', bid=16000068, 'MAISIE', bid=16000069, 'HANK', bid=16000070, 'CORDELIUS', bid=16000071, 'DOUG', bid=16000072, 'PEARL', bid=16000073, 'CHUCK', bid=16000074, 'CHARLIE', bid=16000075, 'MICO', bid=16000076, 'KIT', bid=16000077, 'LARRY & LAWRIE', bid=16000078, 'MELODIE', bid=16000079, 'ANGELO', bid=16000080, 'DRACO', bid=16000081, 'LILY', bid=16000082, 'BERRY', bid=16000083, 'CLANCY', ''), `battle_enemies.brawler_id`)
WHERE trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00');

ALTER TABLE brawltime.brawler UPDATE
  brawler_name=multiIf(brawler_id=16000000, 'SHELLY', brawler_id=16000001, 'COLT', brawler_id=16000002, 'BULL', brawler_id=16000003, 'BROCK', brawler_id=16000004, 'RICO', brawler_id=16000005, 'SPIKE', brawler_id=16000006, 'BARLEY', brawler_id=16000007, 'JESSIE', brawler_id=16000008, 'NITA', brawler_id=16000009, 'DYNAMIKE', brawler_id=16000010, 'EL PRIMO', brawler_id=16000011, 'MORTIS', brawler_id=16000012, 'CROW', brawler_id=16000013, 'POCO', brawler_id=16000014, 'BO', brawler_id=16000015, 'PIPER', brawler_id=16000016, 'PAM', brawler_id=16000017, 'TARA', brawler_id=16000018, 'DARRYL', brawler_id=16000019, 'PENNY', brawler_id=16000020, 'FRANK', brawler_id=16000021, 'GENE', brawler_id=16000022, 'TICK', brawler_id=16000023, 'LEON', brawler_id=16000024, 'ROSA', brawler_id=16000025, 'CARL', brawler_id=16000026, 'BIBI', brawler_id=16000027, '8-BIT', brawler_id=16000028, 'SANDY', brawler_id=16000029, 'BEA', brawler_id=16000030, 'EMZ', brawler_id=16000031, 'MR. P', brawler_id=16000032, 'MAX', brawler_id=16000034, 'JACKY', brawler_id=16000035, 'GALE', brawler_id=16000036, 'NANI', brawler_id=16000037, 'SPROUT', brawler_id=16000038, 'SURGE', brawler_id=16000039, 'COLETTE', brawler_id=16000040, 'AMBER', brawler_id=16000041, 'LOU', brawler_id=16000042, 'BYRON', brawler_id=16000043, 'EDGAR', brawler_id=16000044, 'RUFFS', brawler_id=16000045, 'STU', brawler_id=16000046, 'BELLE', brawler_id=16000047, 'SQUEAK', brawler_id=16000048, 'GROM', brawler_id=16000049, 'BUZZ', brawler_id=16000050, 'GRIFF', brawler_id=16000051, 'ASH', brawler_id=16000052, 'MEG', brawler_id=16000053, 'LOLA', brawler_id=16000054, 'FANG', brawler_id=16000056, 'EVE', brawler_id=16000057, 'JANET', brawler_id=16000058, 'BONNIE', brawler_id=16000059, 'OTIS', brawler_id=16000060, 'SAM', brawler_id=16000061, 'GUS', brawler_id=16000062, 'BUSTER', brawler_id=16000063, 'CHESTER', brawler_id=16000064, 'GRAY', brawler_id=16000065, 'MANDY', brawler_id=16000066, 'R-T', brawler_id=16000067, 'WILLOW', brawler_id=16000068, 'MAISIE', brawler_id=16000069, 'HANK', brawler_id=16000070, 'CORDELIUS', brawler_id=16000071, 'DOUG', brawler_id=16000072, 'PEARL', brawler_id=16000073, 'CHUCK', brawler_id=16000074, 'CHARLIE', brawler_id=16000075, 'MICO', brawler_id=16000076, 'KIT', brawler_id=16000077, 'LARRY & LAWRIE', brawler_id=16000078, 'MELODIE', brawler_id=16000079, 'ANGELO', brawler_id=16000080, 'DRACO', brawler_id=16000081, 'LILY', brawler_id=16000082, 'BERRY', brawler_id=16000083, 'CLANCY', '')
WHERE trophy_season_end IN ('2024-05-27', '2024-06-10', '2024-06-24');

ALTER TABLE brawltime.gear_meta DROP PARTITION '2024-05-27 08:00:00';
ALTER TABLE brawltime.starpower_meta DROP PARTITION '2024-05-27 08:00:00';
ALTER TABLE brawltime.map_meta DROP PARTITION '2024-05-27 08:00:00';
ALTER TABLE brawltime.gadget_meta DROP PARTITION '2024-05-27 08:00:00';
ALTER TABLE brawltime.brawler_enemies_mv DROP PARTITION '2024-05-27 08:00:00';
ALTER TABLE brawltime.brawler_allies_mv DROP PARTITION '2024-05-27 08:00:00';

ALTER TABLE brawltime.gear_meta DROP PARTITION '2024-06-10 08:00:00';
ALTER TABLE brawltime.starpower_meta DROP PARTITION '2024-06-10 08:00:00';
ALTER TABLE brawltime.map_meta DROP PARTITION '2024-06-10 08:00:00';
ALTER TABLE brawltime.gadget_meta DROP PARTITION '2024-06-10 08:00:00';
ALTER TABLE brawltime.brawler_enemies_mv DROP PARTITION '2024-06-10 08:00:00';
ALTER TABLE brawltime.brawler_allies_mv DROP PARTITION '2024-06-10 08:00:00';

ALTER TABLE brawltime.gear_meta DROP PARTITION '2024-06-24 08:00:00';
ALTER TABLE brawltime.starpower_meta DROP PARTITION '2024-06-24 08:00:00';
ALTER TABLE brawltime.map_meta DROP PARTITION '2024-06-24 08:00:00';
ALTER TABLE brawltime.gadget_meta DROP PARTITION '2024-06-24 08:00:00';
ALTER TABLE brawltime.brawler_enemies_mv DROP PARTITION '2024-06-24 08:00:00';
ALTER TABLE brawltime.brawler_allies_mv DROP PARTITION '2024-06-24 08:00:00';

OPTIMIZE TABLE brawltime.battle;
OPTIMIZE TABLE brawltime.gear_meta;
OPTIMIZE TABLE brawltime.starpower_meta;
OPTIMIZE TABLE brawltime.map_meta;
OPTIMIZE TABLE brawltime.brawler_enemies_mv;
OPTIMIZE TABLE brawltime.brawler_allies_mv;

insert into brawltime.gear_meta SELECT     trophy_season_end,     brawler_trophyrange,     brawler_id,     brawler_name,     brawler_gear_id,     brawler_gear_name,     argMaxState(timestamp, timestamp) AS timestamp_state,     count(*) AS picks,     sum(player_brawlers_length) AS picks_weighted,     avgState(battle_duration) AS battle_duration_state,     avgState(battle_rank) AS battle_rank_state,     avgState(brawltime.battle.battle_rank = 1) AS battle_rank1_state,     avgState(battle_victory) AS battle_victory_state,     avgState(brawler_name = battle_starplayer_brawler_name) AS battle_starplayer_state,     avgState(battle_level_id) AS battle_level_state,     avgState(battle_trophy_change) AS battle_trophy_change_state FROM brawltime.battle WHERE brawler_gears_length <= 1 and trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') GROUP BY     trophy_season_end,     brawler_trophyrange,     brawler_id,     brawler_name,     brawler_gear_id,     brawler_gear_name;
insert into brawltime.starpower_meta SELECT     trophy_season_end,     brawler_trophyrange,     brawler_id,     brawler_name,     brawler_starpower_id,     brawler_starpower_name,     argMaxState(timestamp, timestamp) AS timestamp_state,     count(*) AS picks,     sum(player_brawlers_length) AS picks_weighted,     avgState(battle_duration) AS battle_duration_state,     avgState(battle_rank) AS battle_rank_state,     avgState(brawltime.battle.battle_rank = 1) AS battle_rank1_state,     avgState(battle_victory) AS battle_victory_state,     avgState(brawler_name = battle_starplayer_brawler_name) AS battle_starplayer_state,     avgState(battle_level_id) AS battle_level_state,     avgState(battle_trophy_change) AS battle_trophy_change_state FROM brawltime.battle WHERE brawler_starpowers_length <= 1 and trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') GROUP BY     trophy_season_end,     brawler_trophyrange,     brawler_id,     brawler_name,     brawler_starpower_id,     brawler_starpower_name;
insert into brawltime.map_meta SELECT     trophy_season_end,     brawler_trophyrange,     arrayJoin(arrayConcat(battle_allies.brawler_name, [brawler_name])) AS brawler_name,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_event_powerplay,     assumeNotNull(battle_is_bigbrawler) AS battle_is_bigbrawler,     argMaxState(timestamp, timestamp) AS timestamp_state,     count(*) AS picks,     sum(player_brawlers_length) AS picks_weighted,     avgState(battle_duration) AS battle_duration_state,     avgState(battle_rank) AS battle_rank_state,     avgState(brawltime.battle.battle_rank = 1) AS battle_rank1_state,     avgState(battle_victory) AS battle_victory_state,     avgState(brawler_name = battle_starplayer_brawler_name) AS battle_starplayer_state,     avgState(battle_level_id) AS battle_level_state,     avgState(battle_trophy_change) AS battle_trophy_change_state FROM brawltime.battle where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') GROUP BY     trophy_season_end,     brawler_trophyrange,     brawler_name,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_event_powerplay,     battle_is_bigbrawler;
insert into brawltime.gadget_meta SELECT     trophy_season_end,     brawler_trophyrange,     brawler_id,     brawler_name,     brawler_gadget_id,     brawler_gadget_name,     argMaxState(timestamp, timestamp) AS timestamp_state,     count(*) AS picks,     sum(player_brawlers_length) AS picks_weighted,     avgState(battle_duration) AS battle_duration_state,     avgState(battle_rank) AS battle_rank_state,     avgState(brawltime.battle.battle_rank = 1) AS battle_rank1_state,     avgState(battle_victory) AS battle_victory_state,     avgState(brawler_name = battle_starplayer_brawler_name) AS battle_starplayer_state,     avgState(battle_level_id) AS battle_level_state,     avgState(battle_trophy_change) AS battle_trophy_change_state FROM brawltime.battle WHERE brawler_gadgets_length <= 1 and trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') GROUP BY     trophy_season_end,     brawler_trophyrange,     brawler_id,     brawler_name,     brawler_gadget_id,     brawler_gadget_name;

insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 0 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 1 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 2 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 3 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 4 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 5 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 6 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 7 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 8 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 9 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 10 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 11 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 12 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 13 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 14 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;
insert into brawltime.`.inner.brawler_enemies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_enemies.brawler_name AS enemy_brawler_name,     battle_enemies.brawler_id AS enemy_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_enemies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 15 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     enemy_brawler_name,     enemy_brawler_id;

insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 0 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 1 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 2 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 3 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 4 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 5 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 6 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 7 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 8 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 9 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 10 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 11 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 12 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 13 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 14 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;
insert into brawltime.`.inner.brawler_allies_mv` SELECT     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     battle_allies.brawler_name AS ally_brawler_name,     battle_allies.brawler_id AS ally_brawler_id,     toDecimal32(sum(battle_victory), 4) AS battle_victory,     count() AS picks FROM brawltime.battle ARRAY JOIN battle_allies where trophy_season_end IN ('2024-05-27 08:00:00', '2024-06-10 08:00:00', '2024-06-24 08:00:00') and player_id % 16 = 15 GROUP BY     trophy_season_end,     brawler_name,     brawler_id,     brawler_trophyrange,     battle_event_mode,     battle_event_map,     battle_event_id,     ally_brawler_name,     ally_brawler_id;

